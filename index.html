<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Japan Itinerary</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #F8F9FA;
      padding: 1.5rem;
    }

    /* Set up a two-column layout for screens wider than 768px (md breakpoint) */
    @media (min-width: 768px) {
      body {
        display: grid;
        grid-template-columns: 18rem 1fr; /* 18rem sidebar, rest for main content */
        gap: 1.5rem;
      }
      aside {
        position: sticky; /* Keep the navigation fixed on the side */
        top: 1.5rem;
        align-self: start;
        height: fit-content; /* Ensure the height doesn't extend unnecessarily */
      }
      .main-container {
        grid-area: main;
      }
    }
    
    h1, h2 {
      font-family: 'Merriweather', serif;
    }
    
    /* Styles for the responsive itinerary grid view */
    .itinerary-grid {
      display: flex;
      flex-direction: column; /* Default to a single column for mobile */
      gap: 1rem;
    }
    .itinerary-grid .segment-card {
        width: 100%; /* Full width for cards on mobile */
        min-height: auto;
        margin-bottom: 0;
        border: 1px solid #E5E7EB; /* Subtle border for the "cell" look */
    }

    /* Media query for desktop-style horizontal scrolling */
    @media (min-width: 768px) {
      .itinerary-grid {
        flex-direction: row;
        flex-wrap: nowrap;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      .itinerary-grid .segment-card {
        flex: 0 0 20rem; /* Fixed width for each card on desktop */
        min-height: 20rem; /* Consistent height */
      }
    }
    
    /* Hide scrollbar but keep functionality */
    .itinerary-grid::-webkit-scrollbar {
        display: none;
    }
    .toggle-icon {
      transition: transform 0.3s ease-in-out;
    }
  </style>
</head>
<body>
  <aside class="bg-white rounded-xl p-6 mb-6 md:mb-0">
    <h3 class="text-xl font-bold mb-4 text-gray-800">Itinerary Actions</h3>
    <div class="flex flex-col space-y-2 mb-6">
      <button id="expandAll" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-200">
        Expand All
      </button>
      <button id="collapseAll" class="w-full bg-red-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-700 transition-colors duration-200">
      Collapse All
      </button>
    </div>
    <h3 class="text-xl font-bold mb-4 text-gray-800">View Days</h3>
    <ul id="dayNav" class="space-y-2">
      <li>
        <button id="showAll" class="w-full text-left px-4 py-2 rounded-lg text-gray-800 bg-gray-200 font-bold hover:bg-gray-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
          Show All
        </button>
      </li>
    </ul>
  </aside>

  <div class="w-full max-w-7xl bg-white rounded-xl overflow-hidden main-container">
    <header class="bg-indigo-950 text-white py-8 px-6 relative">
      <div class="relative z-10 text-center">
        <h1 class="text-4xl font-extrabold tracking-tight">ðŸ‡¯ðŸ‡µ Japan Itinerary</h1>
        <p class="text-sm mt-2 opacity-80 font-semibold">August 29 â€“ September 8, 2025</p>
      </div>
    </header>
    
    <main id="daySections"></main>
  </div>

  <script>
    // Initial itinerary data
    const itinerary = {
      "Fri 8/29": [
        ["Narita â†’ Shinagawa", "~1 hr 30 min", "Â¥3,070", "~$20", "Land at 4:45pm; customs; board train", "âœˆï¸ Arrival & Reset", "Narita Airport", "Use Suica card for easy transfers", "Booked", "Train"],
        ["Shinagawa â†’ Gotanda", "~6 min", "Â¥150", "~$1", "Transfer to Yamanote Line; check in", "ðŸ¨ Settle In", "OMO5 Tokyo Gotanda", "Grab konbini snacks for late-night cravings", "Booked", "Train"],
        ["â€”", "â€”", "â€”", "â€”", "Dinner nearby; relax", "ðŸœ Local Flavor", "Nishigotanda", "Try izakaya for casual bites", "Not Set", "Walk"]
      ],
      "Sat 8/30": [
        ["Gotanda â†’ Shibuya", "8 min", "Â¥170", "~$1.15", "Lunch at Path or Camelback; Shibuya Crossing", "ðŸ›ï¸ Urban Energy", "Shibuya Crossing", "Shop for vintage bags at Dessert Snow", "Not Set", "Train"],
        ["Shibuya â†’ Harajuku", "3 min", "Â¥150", "~$1.00", "Omotesando, Meiji Jingu Shrine, Takeshita Street", "ðŸŽŒ Youth & Tradition", "Meiji Jingu Shrine", "Go early to avoid crowds", "Not Set", "Train"],
        ["Harajuku â†’ Shinjuku", "5 min", "Â¥150", "~$1.00", "Snack at Usagi Ramen; explore Shinjuku", "ðŸŒ† Neon Nights", "Tokyo Metropolitan Gov. Bldg", "Free observation deck views", "Not Set", "Train"],
        ["Shinjuku â†’ Gotanda", "15 min", "Â¥180", "~$1.20", "Dinner at Kinka Sushi; drinks at SG Club", "ðŸ¶ Nightlife", "SG Club", "Reserve SG Club ahead", "Recommended", "Train"]
      ],
      "Sun 8/31": [
        ["Gotanda â†’ Tsukiji", "~30 min", "Â¥330", "~$2.25", "Explore Tsukiji Outer Market", "ðŸ£ Foodie Day", "Tsukiji Outer Market", "Try tamagoyaki from multiple stalls", "Not Set", "Train"],
        ["Walk to Hamarikyu Gardens", "~10 min", "Free", "Free", "Matcha at teahouse; stroll gardens", "ðŸŒ¿ Zen & Nature", "Hamarikyu Gardens", "Bring insect repellent", "Not Set", "Walk"],
        ["Hamarikyu â†’ Ginza", "~15 min", "Â¥220", "~$1.50", "Shop Ginza SIX, Mitsukoshi, Itoya", "ðŸ’Ž Luxe & Style", "Ginza", "Visit Itoya for unique gifts", "Not Set", "Train/Walk"],
        ["Ginza â†’ Shinjuku", "~20 min", "Â¥200", "~$1.35", "Dinner at Udon Shin", "ðŸœ Hidden Gems", "Udon Shin", "Arrive earlyâ€”long wait!", "Recommended", "Train"],
        ["Shinjuku â†’ Toranomon Hills", "~20 min", "Â¥210", "~$1.40", "Drinks at Andaz Rooftop Bar", "ðŸŒƒ Skyline Views", "Andaz Tokyo", "Dress smart-casual", "Recommended", "Train"],
        ["Toranomon â†’ Gotanda", "~25 min", "Â¥330", "~$2.25", "Return to hotel", "ðŸ’¤ Wind Down", "Gotanda", "Grab dessert at convenience store", "Not Set", "Train"]
      ],
      "Mon 9/1": [
        ["Gotanda â†’ Toyosu", "~35 min", "Â¥330", "~$2.25", "Breakfast at Toyosu Market", "ðŸ£ Culinary Adventure", "Sushi Dai", "Arrive before 7am for best seats", "Recommended", "Train"],
        ["Toyosu â†’ Shin-Toyosu", "~5 min", "Â¥250", "~$1.70", "Visit TeamLab Planets", "ðŸŽ¨ Immersive Art", "TeamLab Planets", "Book tickets online in advance", "Booked", "Train"],
        ["Shin-Toyosu â†’ Asakusa", "~30 min", "Â¥330", "~$2.25", "Explore Sensoji Temple, Nakamise", "ðŸ® Old Tokyo", "Sensoji Temple", "Try kibi dango & melonpan", "Not Set", "Train"],
        ["Asakusa â†’ Otemachi", "~15 min", "Â¥250", "~$1.70", "Dinner at Arva â€“ Aman Tokyo ðŸ’—", "ðŸŽ‰ Anniversary Night", "Aman Tokyo", "Confirm reservation in advance", "Booked", "Train"],
        ["Otemachi â†’ Shinjuku", "~20 min", "Â¥330", "~$2.25", "Explore Golden Gai", "ðŸ¶ Retro Vibes", "Golden Gai", "Explore quirky bars", "Not Set", "Train"],
        ["Shinjuku â†’ Azabujuban", "~15 min", "Â¥250", "~$1.70", "Drinks at Bar Centifolia or Tokyo Confidential", "ðŸ¸ Elegant Evenings", "Bulgari Hotel", "Reserve ahead for rooftop seating", "Recommended", "Train"],
        ["Azabujuban â†’ Gotanda", "~25 min", "Â¥330", "~$2.25", "Return to hotel", "ðŸ’¤ Wind Down", "Gotanda", "â€”", "Not Set", "Train"]
      ],
      "Tue 9/2": [
        ["Tokyo â†’ Kyoto (Nozomi)", "~2 hr 15 min", "Â¥14,000", "~$90", "Grab ekiben at Tokyo Station", "ðŸš„ Scenic Shift", "Shinkansen Ride", "Book Nozomi seats early", "Recommended", "Shinkansen"],
        ["Kyoto â†’ Nohga Hotel Kiyomizu", "~20â€“30 min", "Â¥500â€“Â¥2,000", "~$3â€“$13", "Check-in", "ðŸ¨ Arrival & Refresh", "Nohga Hotel", "Use taxi for comfort", "Booked", "Taxi/Local Train"],
        ["Hotel â†’ Fushimi Inari", "~20 min", "Â¥200â€“Â¥300", "~$2", "Explore red torii gates", "ðŸ”´ Spiritual Path", "Fushimi Inari", "Go before sunset for golden light", "Not Set", "Local Train"],
        ["Fushimi â†’ Higashiyama", "~20 min", "Â¥200â€“Â¥300", "~$2", "Hanami-koji, Shirakawa Canal, Tatsumi Shrine", "ðŸ® Historic Charm", "Gion", "Watch for geisha sightings", "Not Set", "Local Train/Walk"],
        ["Walk to Yasaka Shrine & Kodai-ji", "~10â€“15 min", "Free", "Free", "Sunset at Kiyomizu-dera", "ðŸŒ… Golden Hour", "Kiyomizu-dera", "Bring a tripod for photos", "Not Set", "Walk"],
        ["Taxi to Mouriya", "~15 min", "Â¥1,000â€“Â¥2,000", "~$7â€“$13", "Wagyu dinner", "ðŸ¥© Gourmet Night", "Mouriya", "Reserve table in advance", "Booked", "Taxi"],
        ["Return to hotel", "~15 min", "Â¥1,000", "~$7", "â€”", "ðŸ’¤ Wind Down", "Nohga Hotel", "â€”", "Not Set", "Taxi/Walk"]
      ],
      "Wed 9/3": [
        ["Hotel â†’ Kinkaku-ji", "~30 min", "Â¥1,000â€“Â¥2,000", "~$7â€“$13", "Visit Golden Pavilion early", "ðŸ¯ Iconic Kyoto", "Kinkaku-ji", "Bring a wide-angle lens", "Not Set", "Taxi/Local Train"],
        ["Kinkaku-ji â†’ Arashiyama", "~30â€“40 min", "Â¥500â€“Â¥1,000", "~$3â€“$7", "Bamboo Forest, Monkey Park, Sanso Garden", "ðŸŒ³ Nature & Wildlife", "Arashiyama Bamboo Grove", "Arrive early for fewer crowds", "Not Set", "Bike/Train"],
        ["Arashiyama â†’ Otagi Nenbutsuji", "~15â€“20 min", "Â¥500â€“Â¥1,000", "~$3â€“$7", "Visit temples, Kotouen pottery", "â›©ï¸ Temple Hopping", "Otagi Nenbutsuji", "â€”", "Not Set", "Bike/Taxi"],
        ["Arashiyama â†’ Izumoya", "~30 min", "Â¥1,500â€“Â¥2,500", "~$10â€“$17", "Dinner at Izumoya by the river", "ðŸœ Riverfront Dining", "Izumoya", "â€”", "Not Set", "Taxi"],
        ["Izumoya â†’ Park Hyatt", "~15 min", "Â¥1,000", "~$7", "Drinks at Kohaku Bar", "ðŸ¸ Elegant Evenings", "Park Hyatt", "â€”", "Not Set", "Taxi"],
        ["Park Hyatt â†’ Hotel", "~20 min", "Â¥1,000â€“Â¥2,000", "~$7â€“$13", "Return to hotel", "ðŸ’¤ Wind Down", "Nohga Hotel", "â€”", "Not Set", "Taxi"]
      ],
      "Thu 9/4": [
        ["Kyoto â†’ Osaka", "~30 min", "Â¥1,500â€“Â¥3,000", "~$10â€“$20", "Visit Osaka Castle", "ðŸ¯ Historic Landmark", "Osaka Castle", "â€”", "Not Set", "Shinkansen/Local Train"],
        ["Osaka Castle â†’ Izakaya Toyo", "~20 min", "Â¥200â€“Â¥300", "~$2", "Street food at Netflix-famous Izakaya Toyo", "ðŸ¢ Street Food", "Izakaya Toyo", "â€”", "Not Set", "Local Train"],
        ["Osaka â†’ Kyoto", "~30 min", "Â¥1,500â€“Â¥3,000", "~$10â€“$20", "Return to Kyoto", "ðŸš„ City Shift", "â€”", "â€”", "Not Set", "Shinkansen/Local Train"],
        ["Kyoto Station â†’ Hotel Mitsui", "~15 min", "Â¥500â€“Â¥1,000", "~$3â€“$7", "Check-in at 3pm", "ðŸ¨ Settle In", "Hotel Mitsui", "â€”", "Booked", "Train"],
        ["Hotel â†’ Kiyamachi Dori Street", "~10 min", "Free", "Free", "Explore riverside nightlife", "ðŸŒƒ Neon Nights", "Kiyamachi Dori", "â€”", "Not Set", "Walk"],
        ["Walk to Sushitetsu", "~5 min", "Free", "Free", "Dinner at Sushitetsu", "ðŸ£ Local Flavor", "Sushitetsu", "â€”", "Not Set", "Walk"],
        ["Sushitetsu â†’ Hotel Mitsui", "~10 min", "Free", "Free", "Return to hotel", "ðŸ’¤ Wind Down", "Hotel Mitsui", "â€”", "Not Set", "Walk"]
      ],
      "Fri 9/5": [
        ["Hotel â†’ Tea Ceremony", "~20 min", "Â¥1,000â€“Â¥2,000", "~$7â€“$13", "Visit Maikoya or Rokujuan", "ðŸµ Cultural Experience", "Maikoya or Rokujuan", "â€”", "Recommended", "Taxi/Local"],
        ["Tea Ceremony â†’ Imperial Palace", "~20 min", "Â¥500â€“Â¥1,000", "~$3â€“$7", "Historical tour of Imperial Palace & Nijo Castle", "ðŸ¯ Historic Tour", "Imperial Palace & Nijo Castle", "â€”", "Not Set", "Local"],
        ["Nijo â†’ Fushimi Inari", "~30 min", "Â¥300â€“Â¥500", "~$2â€“$4", "Shrine revisit", "â›©ï¸ Spiritual Path", "Fushimi Inari", "â€”", "Not Set", "Local Train"],
        ["Ninen-zaka â†’ Hotel Mitsui", "~20 min", "Â¥500â€“Â¥1,000", "~$3â€“$7", "Afternoon massage", "ðŸ’†â€â™€ï¸ Relaxation", "â€”", "Not Set", "Taxi"],
        ["Hotel Mitsui â†’ Restaurant", "~1 min", "Free", "Free", "Dinner at hotel", "ðŸ½ï¸ Fine Dining", "Hotel Restaurant", "â€”", "Not Set", "On-site"]
      ],
      "Sat 9/6": [
        ["Kyoto â†’ Odawara", "~2 hr", "Â¥13,000", "~$85", "Grab breakfast, check out from Hotel Mitsui", "ðŸš„ Scenic Shift", "Shinkansen Ride", "â€”", "Not Set", "Shinkansen"],
        ["Odawara â†’ Hakone", "~30â€“45 min", "Â¥500â€“Â¥2,000", "~$3â€“$13", "Scenic ride into mountains", "â›°ï¸ Nature & Views", "Hakone", "â€”", "Not Set", "Local Train/Taxi"],
        ["Hakone â†’ Hyatt Regency Hakone", "~15 min", "Free", "Free", "Check-in, relax", "ðŸ¨ Settle In", "Hyatt Regency", "â€”", "Booked", "Shuttle"],
        ["Hotel â†’ Spa Izumi & Onsen", "On-site", "Reservation needed", "Varies", "Spa treatment or hot spring soak", "â™¨ï¸ Onsen & Spa", "Spa Izumi & Onsen", "Reserve in advance", "Recommended", "On-site"],
        ["Hotel â†’ Dinner", "Varies", "Varies", "Varies", "Optional dinner at hotel or local restaurant", "ðŸ½ï¸ Dinner", "â€”", "â€”", "Not Set", "Walk/Taxi"]
      ],
      "Sun 9/7": [
        ["Hotel â†’ Hakone Open-Air Museum", "~10 min", "Â¥1,000", "~$7", "Sculpture gardens, Picasso Pavilion", "ðŸ–¼ï¸ Art & Nature", "Hakone Open-Air Museum", "â€”", "Not Set", "Taxi"],
        ["Museum â†’ Hakone Shrine", "~20â€“30 min", "Â¥500â€“Â¥1,000", "~$3â€“$7", "Visit lakeside torii gate", "â›©ï¸ Sacred Site", "Hakone Shrine", "â€”", "Not Set", "Walk"],
        ["Shrine â†’ Lake Ashi Cruise Pier", "~10 min walk", "Free", "Free", "Board pirate-style sightseeing cruise", "ðŸš¢ Lake Cruise", "Lake Ashi", "â€”", "Not Set", "Walk"],
        ["Cruise Pier â†’ Itoh Dining by Nobu", "~10 min walk", "Free", "Free", "Dinner at Itoh Dining", "ðŸ¥© Teppanyaki", "Itoh Dining by Nobu", "Sit at teppanyaki bar", "Recommended", "Walk"],
        ["Itoh â†’ Hotel", "~10â€“15 min", "Â¥1,000", "~$7", "Return to Hyatt Regency Hakone", "ðŸ’¤ Wind Down", "Hyatt Regency", "â€”", "Not Set", "Walk/Taxi"]
      ],
      "Mon 9/8": [
        ["Hotel â†’ Odawara Station", "~45 min", "Free", "Free", "Check out, light breakfast", "âœˆï¸ Departure", "Odawara Station", "â€”", "Not Set", "Shuttle"],
        ["Odawara â†’ Tokyo Station", "~40 min", "Â¥3,500", "~$23", "Optional snack or coffee at Tokyo Station", "ðŸš„ City Shift", "Tokyo Station", "â€”", "Not Set", "Shinkansen"],
        ["Tokyo â†’ Narita", "~1 hr", "Â¥2,700â€“Â¥5,500", "~$18â€“$37", "Final souvenir shopping, relax before flight", "âœˆï¸ Departure", "Narita Airport", "Arrive early for check-in and security", "Booked", "Train"]
      ]
    };

    const sectionsContainer = document.getElementById("daySections");
    const dayNavContainer = document.getElementById("dayNav");
    const expandAllButton = document.getElementById("expandAll");
    const collapseAllButton = document.getElementById("collapseAll");
    const showAllButton = document.getElementById("showAll");

    const getStatusClass = (status) => {
      switch (status) {
        case 'Booked': return 'bg-green-100 text-green-700';
        case 'Recommended': return 'bg-orange-100 text-orange-700';
        case 'Canceled': return 'bg-red-100 text-red-700';
        default: return 'bg-gray-200 text-gray-700';
      }
    };

    const createSegmentCard = (segment) => {
      const segmentTitle = segment[5];
      const segmentDetails = segment[0];
      const details = segment[4];
      const notes = segment[7];
      const status = segment[8];

      const travelParts = segmentDetails.includes('â†’') ? segmentDetails.split(' â†’ ') : [null, null];
      const startLocation = travelParts[0];
      const destinationLocation = travelParts[1];

      const travelDetailsHTML = startLocation && destinationLocation ? `
        <div>
          <span class="font-semibold text-gray-800">Starting Location:</span> ${startLocation}
        </div>
        <div>
          <span class="font-semibold text-gray-800">Destination:</span> ${destinationLocation}
        </div>
      ` : `
        <div class="col-span-2">
          <span class="font-semibold text-gray-800">Segment:</span> ${segmentDetails}
        </div>
      `;

      return `
        <div class="bg-white p-4 rounded-lg shadow-sm mb-4 last:mb-0 segment-card flex flex-col justify-between">
          <div class="mb-2">
            <h4 class="text-lg font-bold text-gray-900">${segmentTitle}</h4>
            <p class="text-sm text-gray-500">${segmentDetails}</p>
          </div>
          
          <div class="grid grid-cols-2 gap-y-1 gap-x-4 text-sm text-gray-600 mb-2">
            ${travelDetailsHTML}
            <div>
              <span class="font-semibold text-gray-800">Travel Time:</span> ${segment[1]}
            </div>
            <div>
              <span class="font-semibold text-gray-800">Travel Type:</span> ${segment[9]}
            </div>
            <div>
              <span class="font-semibold text-gray-800">Cost:</span> ${segment[2]} (${segment[3]})
            </div>
            <div>
              <span class="font-semibold text-gray-800">Location:</span> ${segment[6]}
            </div>
          </div>
          
          <div class="mt-2 text-sm text-gray-700">
            <span class="font-semibold text-gray-800">Details:</span> ${details}
          </div>
          <div class="mt-2 text-sm text-gray-700">
            <span class="font-semibold text-gray-800">Notes:</span> ${notes}
          </div>

          <div class="mt-4">
            <span class="inline-block px-3 py-1 rounded-full text-xs font-semibold ${getStatusClass(status)}">${status}</span>
          </div>
        </div>
      `;
    };
    
    const toggleDay = (dayContainer) => {
      const content = dayContainer.querySelector('.itinerary-content');
      const toggleIcon = dayContainer.querySelector('.toggle-icon');
      
      if (content.style.display === 'none') {
        content.style.display = 'flex';
        toggleIcon.textContent = 'â–¼';
      } else {
        content.style.display = 'none';
        toggleIcon.textContent = 'â–¶';
      }
    };
    
    const renderItinerary = () => {
      Object.entries(itinerary).forEach(([day, segments], index) => {
        const dayId = day.replace(/[\s/]/g, '_');
        const dayContainer = document.createElement("div");
        dayContainer.className = "mb-6 rounded-xl overflow-hidden bg-white day-section";
        dayContainer.id = dayId;

        let cityForDay = '';
        switch (day) {
          case 'Fri 8/29':
          case 'Sat 8/30':
          case 'Sun 8/31':
          case 'Mon 9/1':
            cityForDay = 'Tokyo';
            break;
          case 'Tue 9/2':
          case 'Wed 9/3':
          case 'Fri 9/5':
            cityForDay = 'Kyoto';
            break;
          case 'Thu 9/4':
            cityForDay = 'Osaka';
            break;
          case 'Sat 9/6':
          case 'Sun 9/7':
            cityForDay = 'Hakone';
            break;
          case 'Mon 9/8':
            cityForDay = 'Tokyo';
            break;
        }
        
        const firstSegmentSummary = segments[0][5];
        const header = document.createElement("div");
        header.className = "p-4 md:p-6 bg-blue-800 text-white cursor-pointer hover:bg-blue-700 transition-colors duration-200 flex justify-between items-center";
        header.innerHTML = `
          <div class="flex flex-col items-start flex-grow">
            <h2 class="text-xl font-bold">${day} â€“ ${cityForDay}</h2>
            <p class="text-sm opacity-80 mt-1">${firstSegmentSummary}</p>
          </div>
          <div class="flex items-center space-x-2">
            <span class="toggle-icon text-xl">â–¼</span>
          </div>
        `;
        
        header.addEventListener('click', () => {
          toggleDay(dayContainer);
        });
        
        dayContainer.appendChild(header);

        const content = document.createElement("div");
        content.className = "px-4 py-8 itinerary-content itinerary-grid";
        content.style.display = 'flex'; // Ensure initial state is visible
        
        const cardHTML = segments.map(createSegmentCard).join('');
        content.innerHTML = cardHTML;
        dayContainer.appendChild(content);

        sectionsContainer.appendChild(dayContainer);

        const navItem = document.createElement("li");
        navItem.innerHTML = `
          <button class="day-filter w-full text-left px-4 py-2 rounded-lg text-gray-600 hover:bg-gray-200 transition-colors duration-200" data-day-id="${dayId}">${day}</button>
        `;
        dayNavContainer.appendChild(navItem);
      });
    };
    
    expandAllButton.addEventListener('click', () => {
      document.querySelectorAll('.itinerary-content').forEach(content => {
        content.style.display = 'flex';
        content.previousElementSibling.querySelector('.toggle-icon').textContent = 'â–¼';
      });
    });

    collapseAllButton.addEventListener('click', () => {
      document.querySelectorAll('.itinerary-content').forEach(content => {
        content.style.display = 'none';
        content.previousElementSibling.querySelector('.toggle-icon').textContent = 'â–¶';
      });
    });
    
    showAllButton.addEventListener('click', () => {
      document.querySelectorAll('.day-section').forEach(section => {
        section.style.display = '';
      });
    });

    dayNavContainer.addEventListener('click', (e) => {
      const dayFilterBtn = e.target.closest('.day-filter');
      if (dayFilterBtn) {
        const dayIdToFilter = dayFilterBtn.dataset.dayId;
        document.querySelectorAll('.day-section').forEach(section => {
          if (section.id === dayIdToFilter) {
            section.style.display = '';
          } else {
            section.style.display = 'none';
          }
        });
      }
    });

    document.addEventListener('DOMContentLoaded', renderItinerary);
  </script>
</body>
</html>
